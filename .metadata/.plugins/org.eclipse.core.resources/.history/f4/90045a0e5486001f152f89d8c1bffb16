/*
 * kernel.c
 *
 *  Created on: 09-Oct-2024
 *      Author: saka6
 */
#include "kernel.h"
/*xpsr
 * PC
 * LR
 * R12
 * R3
 * R2
 * R1
 * R0(TOP) GETS AUTOMATICALLY SAVED
 */
#define NUM_OF_THREADS	3
#define STACK_SIZE		100

struct tcb{
	int32_t *stackPt;
	struct tcb *nextPt;
};

typedef struct tcb tcbType;
tcbType tcbs[NUM_OF_THREADS];
tcbType *currentPt;

int32_t TCB_STACK[NUM_OF_THREADS][STACK_SIZE];

void osKernelStackInit(int i)
{
	TCB_STACK[i][STACK_SIZE - 1] = (1U<<21); //psr = thumb mode

	TCB_STACK[i][STACK_SIZE - 3] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 4] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 5] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 6] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 7] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 8] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 9] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 10] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 11] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 12] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 13] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 14] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 15] = 0XAAAAAAAA;
	TCB_STACK[i][STACK_SIZE - 16] = 0XAAAAAAAA;

}
